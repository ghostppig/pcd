CREATE TABLE `wxbsbankaccount_vertical` (
  `acctname` varchar(128) NOT NULL,
  `paymenttype` varchar(128) NOT NULL,
  `createtime` datetime(3) DEFAULT NULL,
  `entname` varchar(128) NOT NULL,
  `settletype` varchar(128) NOT NULL,
  `chargerate` decimal(10,5) NOT NULL,
  `taxfactor` int(11) NOT NULL,
  `refundfactor` int(11) NOT NULL,
  `needsettle` int(11) NOT NULL,
  `refundexpire` bigint(20) DEFAULT NULL,
  `update_time` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
  PRIMARY KEY (`acctname`,`paymenttype`),
  KEY `ix_ent` (`entname`),
  KEY `ix_settletype` (`settletype`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

alter VIEW viewbankaccounts AS
select acct.acctname,acct.settleType,acct.createtime,acct.paymenttype,acct.chargerate,acct.refundfactor,acct.taxfactor,acct.needsettle,acct.refundexpire,acct.entname,ent.entinfo from
    wxbsbankaccount_vertical acct
    JOIN (SELECT gw.EntName, meta.payment_type AS paymenttype FROM wxbsgateway gw JOIN meta_gw_type meta ON gw.GwType = meta.gw_type
      GROUP BY gw.EntName, meta.payment_type) entgwtype ON entgwtype.entname = acct.entname and entgwtype.paymenttype = acct.paymenttype
    JOIN wxbsenterprise ent ON acct.entname = ent.entname;

INSERT INTO wxbsbankaccount_vertical(paymenttype,acctname,settletype,createtime,chargerate,refundfactor,taxfactor,needsettle,refundexpire,entname)
SELECT 'WECHATPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.chargerate,0) AS chargerate, IFNULL(acct.excluderefunded,1) AS refundfactor, IFNULL(acct.excisedutyfactor,0) AS taxfactor, IFNULL(acct.wechatpayneedsettle,1) AS needsettle,acct.wechatpayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'ALIPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.alipaychargerate,0) AS chargerate, IFNULL(acct.alipayrefundfactor,1) AS refundfactor, IFNULL(acct.alipaytaxfactor,0) AS taxfactor, IFNULL(acct.alipayneedsettle,1) AS needsettle,acct.alipayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'LINEPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.linepaychargerate,0) AS chargerate, IFNULL(acct.linepayrefundfactor,1) AS refundfactor, IFNULL(acct.linepaytaxfactor,1) AS taxfactor, IFNULL(acct.linepayneedsettle,1) AS needsettle,acct.linepayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'DPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.dpaychargerate,0) AS chargerate, IFNULL(acct.dpayrefundfactor,1) AS refundfactor, IFNULL(acct.dpaytaxfactor,1) AS taxfactor, IFNULL(acct.dpayneedsettle,1) AS needsettle,acct.dpayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'CNPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.chinapaychargerate,0) AS chargerate, IFNULL(acct.chinapayrefundfactor,1) AS refundfactor, IFNULL(acct.chinapaytaxfactor,0) AS taxfactor, IFNULL(acct.chinapayneedsettle,1) AS needsettle,acct.chinapayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'PAYPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.paypaychargerate,0) AS chargerate, IFNULL(acct.paypayrefundfactor,1) AS refundfactor, IFNULL(acct.paypaytaxfactor,0) AS taxfactor, IFNULL(acct.paypayneedsettle,1) AS needsettle,acct.paypayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'RAKUTENPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.rakutenpaychargerate,0) AS chargerate, IFNULL(acct.rakutenpayrefundfactor,1) AS refundfactor, IFNULL(acct.rakutenpaytaxfactor,0) AS taxfactor, IFNULL(acct.rakutenpayneedsettle,1) AS needsettle,acct.rakutenpayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'UPI' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.upichargerate,0) AS chargerate, IFNULL(acct.upirefundfactor,1) AS refundfactor, IFNULL(acct.upitaxfactor,0) AS taxfactor, IFNULL(acct.upineedsettle,1) AS needsettle,acct.upirefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'ORIGAMIPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.origamipaychargerate,0) AS chargerate, IFNULL(acct.origamipayrefundfactor,1) AS refundfactor, IFNULL(acct.origamipaytaxfactor,0) AS taxfactor, IFNULL(acct.origamipayneedsettle,1) AS needsettle,acct.origamipayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'GINKOPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.ginkopaychargerate,0) AS chargerate, IFNULL(acct.ginkopayrefundfactor,1) AS refundfactor, IFNULL(acct.ginkopaytaxfactor,0) AS taxfactor, IFNULL(acct.ginkopayneedsettle,1) AS needsettle,acct.ginkopayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'MERPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.merpaychargerate,0) AS chargerate, IFNULL(acct.merpayrefundfactor,1) AS refundfactor, IFNULL(acct.merpaytaxfactor,0) AS taxfactor, IFNULL(acct.merpayneedsettle,1) AS needsettle,acct.merpayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'AUPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.aupaychargerate,0) AS chargerate, IFNULL(acct.aupayrefundfactor,1) AS refundfactor, IFNULL(acct.aupaytaxfactor,0) AS taxfactor, IFNULL(acct.aupayneedsettle,1) AS needsettle,acct.aupayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'QUOPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.quopaychargerate,0) AS chargerate, IFNULL(acct.quopayrefundfactor,1) AS refundfactor, IFNULL(acct.quopaytaxfactor,0) AS taxfactor, IFNULL(acct.quopayneedsettle,1) AS needsettle,acct.quopayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'VIADASH' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.viadashchargerate,0) AS chargerate, IFNULL(acct.viadashrefundfactor,1) AS refundfactor, IFNULL(acct.viadashtaxfactor,0) AS taxfactor, IFNULL(acct.viadashneedsettle,1) AS needsettle,acct.viadashrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'VIAMPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.viampaychargerate,0) AS chargerate, IFNULL(acct.viampayrefundfactor,1) AS refundfactor, IFNULL(acct.viampaytaxfactor,0) AS taxfactor, IFNULL(acct.viampayneedsettle,1) AS needsettle,acct.viampayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'GLNPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.glnpaychargerate,0) AS chargerate, IFNULL(acct.glnpayrefundfactor,1) AS refundfactor, IFNULL(acct.glnpaytaxfactor,0) AS taxfactor, IFNULL(acct.glnpayneedsettle,1) AS needsettle,acct.glnpayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct  UNION ALL
SELECT 'AMAZONPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.amazonpaychargerate,0) AS chargerate, IFNULL(acct.amazonpayrefundfactor,1) AS refundfactor, IFNULL(acct.amazonpaytaxfactor,0) AS taxfactor, IFNULL(acct.amazonpayneedsettle,1) AS needsettle,acct.amazonpayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'JCOINPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.jcoinpaychargerate,0) AS chargerate, IFNULL(acct.jcoinpayrefundfactor,1) AS refundfactor, IFNULL(acct.jcoinpaytaxfactor,0) AS taxfactor, IFNULL(acct.jcoinpayneedsettle,1) AS needsettle,acct.jcoinpayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'JKOPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.jkopaychargerate,0) AS chargerate, IFNULL(acct.jkopayrefundfactor,1) AS refundfactor, IFNULL(acct.jkopaytaxfactor,0) AS taxfactor, IFNULL(acct.jkopayneedsettle,1) AS needsettle,acct.jkopayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'BANKIT' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.bankitchargerate,0) AS chargerate, IFNULL(acct.bankitrefundfactor,1) AS refundfactor, IFNULL(acct.bankittaxfactor,0) AS taxfactor, IFNULL(acct.bankitneedsettle,1) AS needsettle,acct.bankitrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'SMARTCODE' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.smartcodechargerate,0) AS chargerate, IFNULL(acct.smartcoderefundfactor,1) AS refundfactor, IFNULL(acct.smartcodetaxfactor,0) AS taxfactor, IFNULL(acct.smartcodeneedsettle,1) AS needsettle,acct.smartcoderefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'BANKPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.bankpaychargerate,0) AS chargerate, IFNULL(acct.bankpayrefundfactor,1) AS refundfactor, IFNULL(acct.bankpaytaxfactor,0) AS taxfactor, IFNULL(acct.bankpayneedsettle,1) AS needsettle,acct.bankpayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'ATONEPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.atonepaychargerate,0) AS chargerate, IFNULL(acct.atonepayrefundfactor,1) AS refundfactor, IFNULL(acct.atonepaytaxfactor,0) AS taxfactor, IFNULL(acct.atonepayneedsettle,1) AS needsettle,acct.atonepayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'AFTEEPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.afteepaychargerate,0) AS chargerate, IFNULL(acct.afteepayrefundfactor,1) AS refundfactor, IFNULL(acct.afteepaytaxfactor,0) AS taxfactor, IFNULL(acct.afteepayneedsettle,1) AS needsettle,acct.afteepayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'FAMIPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.famipaychargerate,0) AS chargerate, IFNULL(acct.famipayrefundfactor,1) AS refundfactor, IFNULL(acct.famipaytaxfactor,0) AS taxfactor, IFNULL(acct.famipayneedsettle,1) AS needsettle,acct.famipayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'EGIFTEE' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.egifteechargerate,0) AS chargerate, IFNULL(acct.egifteerefundfactor,1) AS refundfactor, IFNULL(acct.egifteetaxfactor,0) AS taxfactor, IFNULL(acct.egifteeneedsettle,1) AS needsettle,acct.egifteerefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'GOTOEAT' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.gotoeatchargerate,0) AS chargerate, IFNULL(acct.gotoeatrefundfactor,1) AS refundfactor, IFNULL(acct.gotoeattaxfactor,0) AS taxfactor, IFNULL(acct.gotoeatneedsettle,1) AS needsettle,acct.gotoeatrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'MONEYTAP' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.moneytapchargerate,0) AS chargerate, IFNULL(acct.moneytaprefundfactor,1) AS refundfactor, IFNULL(acct.moneytaptaxfactor,0) AS taxfactor, IFNULL(acct.moneytapneedsettle,1) AS needsettle,acct.moneytaprefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'VISA' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.visachargerate,0) AS chargerate, IFNULL(acct.visarefundfactor,1) AS refundfactor, IFNULL(acct.visataxfactor,0) AS taxfactor, IFNULL(acct.visaneedsettle,1) AS needsettle,acct.visarefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'MARSTERCARD' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.mastercardchargerate,0) AS chargerate, IFNULL(acct.mastercardrefundfactor,1) AS refundfactor, IFNULL(acct.mastercardtaxfactor,0) AS taxfactor, IFNULL(acct.mastercardneedsettle,1) AS needsettle,acct.mastercardrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'HAMAPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.hamapaychargerate,0) AS chargerate, IFNULL(acct.hamapayrefundfactor,1) AS refundfactor, IFNULL(acct.hamapaytaxfactor,0) AS taxfactor, IFNULL(acct.hamapayneedsettle,1) AS needsettle,acct.hamapayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'NISSENREN' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.nissenrenchargerate,0) AS chargerate, IFNULL(acct.nissenrenrefundfactor,1) AS refundfactor, IFNULL(acct.nissenrentaxfactor,0) AS taxfactor, IFNULL(acct.nissenrenneedsettle,1) AS needsettle,acct.nissenrenrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'PAYPAL' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.paypalchargerate,0) AS chargerate, IFNULL(acct.paypalrefundfactor,1) AS refundfactor, IFNULL(acct.paypaltaxfactor,0) AS taxfactor, IFNULL(acct.paypalneedsettle,1) AS needsettle,acct.paypalrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'MBBANKPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.mbbankpaychargerate,0) AS chargerate, IFNULL(acct.mbbankpayrefundfactor,1) AS refundfactor, IFNULL(acct.mbbankpaytaxfactor,0) AS taxfactor, IFNULL(acct.mbbankpayneedsettle,1) AS needsettle,acct.mbbankpayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'SPPREMIUM' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.sppremiumchargerate,0) AS chargerate, IFNULL(acct.sppremiumrefundfactor,1) AS refundfactor, IFNULL(acct.sppremiumtaxfactor,0) AS taxfactor, IFNULL(acct.sppremiumneedsettle,1) AS needsettle,acct.sppremiumrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'NSPOINT' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.nspointchargerate,0) AS chargerate, IFNULL(acct.nspointrefundfactor,1) AS refundfactor, IFNULL(acct.nspointtaxfactor,0) AS taxfactor, IFNULL(acct.nspointneedsettle,1) AS needsettle,acct.nspointrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct UNION ALL
SELECT 'PROMPTPAY' as paymenttype,acct.acctname,acct.settleType,acct.createtime, IFNULL(acct.promptpaychargerate,0) AS chargerate, IFNULL(acct.promptpayrefundfactor,1) AS refundfactor, IFNULL(acct.promptpaytaxfactor,0) AS taxfactor, IFNULL(acct.promptpayneedsettle,1) AS needsettle,acct.promptpayrefundexpire AS refundexpire,acct.entname
FROM wxbsbankaccount acct;

delimiter $$
CREATE TRIGGER insert_vertical after insert ON wxbsbankaccount
    FOR EACH ROW
BEGIN
    INSERT INTO wxbsbankaccount_vertical(paymenttype,acctname,settletype,createtime,chargerate,refundfactor,taxfactor,needsettle,refundexpire,entname)
        values
            ('WECHATPAY', NEW.acctname, NEW.settleType, NEW.createtime, IFNULL(NEW.chargerate,0), IFNULL(NEW.excluderefunded,1), IFNULL(NEW.excisedutyfactor,0), IFNULL(NEW.wechatpayneedsettle,1), NEW.wechatpayrefundexpire, NEW.entname),
            ('ALIPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.alipaychargerate,0), IFNULL(NEW.alipayrefundfactor,1), IFNULL(NEW.alipaytaxfactor,0), IFNULL(NEW.alipayneedsettle,1), NEW.alipayrefundexpire, NEW.entname),
            ('LINEPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.linepaychargerate,0), IFNULL(NEW.linepayrefundfactor,1), IFNULL(NEW.linepaytaxfactor,1), IFNULL(NEW.linepayneedsettle,1), NEW.linepayrefundexpire, NEW.entname),
            ('DPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.dpaychargerate,0), IFNULL(NEW.dpayrefundfactor,1), IFNULL(NEW.dpaytaxfactor,1), IFNULL(NEW.dpayneedsettle,1), NEW.dpayrefundexpire, NEW.entname),
            ('CNPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.chinapaychargerate,0), IFNULL(NEW.chinapayrefundfactor,1), IFNULL(NEW.chinapaytaxfactor,0), IFNULL(NEW.chinapayneedsettle,1), NEW.chinapayrefundexpire, NEW.entname),
            ('PAYPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.paypaychargerate,0), IFNULL(NEW.paypayrefundfactor,1), IFNULL(NEW.paypaytaxfactor,0), IFNULL(NEW.paypayneedsettle,1), NEW.paypayrefundexpire, NEW.entname),
            ('RAKUTENPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.rakutenpaychargerate,0), IFNULL(NEW.rakutenpayrefundfactor,1), IFNULL(NEW.rakutenpaytaxfactor,0), IFNULL(NEW.rakutenpayneedsettle,1), NEW.rakutenpayrefundexpire, NEW.entname),
            ('UPI', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.upichargerate,0), IFNULL(NEW.upirefundfactor,1), IFNULL(NEW.upitaxfactor,0), IFNULL(NEW.upineedsettle,1), NEW.upirefundexpire, NEW.entname),
            ('ORIGAMIPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.origamipaychargerate,0), IFNULL(NEW.origamipayrefundfactor,1), IFNULL(NEW.origamipaytaxfactor,0), IFNULL(NEW.origamipayneedsettle,1), NEW.origamipayrefundexpire, NEW.entname),
            ('GINKOPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.ginkopaychargerate,0), IFNULL(NEW.ginkopayrefundfactor,1), IFNULL(NEW.ginkopaytaxfactor,0), IFNULL(NEW.ginkopayneedsettle,1), NEW.ginkopayrefundexpire, NEW.entname),
            ('MERPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.merpaychargerate,0), IFNULL(NEW.merpayrefundfactor,1), IFNULL(NEW.merpaytaxfactor,0), IFNULL(NEW.merpayneedsettle,1), NEW.merpayrefundexpire, NEW.entname),
            ('AUPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.aupaychargerate,0), IFNULL(NEW.aupayrefundfactor,1), IFNULL(NEW.aupaytaxfactor,0), IFNULL(NEW.aupayneedsettle,1), NEW.aupayrefundexpire, NEW.entname),
            ('QUOPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.quopaychargerate,0), IFNULL(NEW.quopayrefundfactor,1), IFNULL(NEW.quopaytaxfactor,0), IFNULL(NEW.quopayneedsettle,1), NEW.quopayrefundexpire, NEW.entname),
            ('VIADASH', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.viadashchargerate,0), IFNULL(NEW.viadashrefundfactor,1), IFNULL(NEW.viadashtaxfactor,0), IFNULL(NEW.viadashneedsettle,1), NEW.viadashrefundexpire, NEW.entname),
            ('VIAMPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.viampaychargerate,0), IFNULL(NEW.viampayrefundfactor,1), IFNULL(NEW.viampaytaxfactor,0), IFNULL(NEW.viampayneedsettle,1), NEW.viampayrefundexpire, NEW.entname),
            ('GLNPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.glnpaychargerate,0), IFNULL(NEW.glnpayrefundfactor,1), IFNULL(NEW.glnpaytaxfactor,0), IFNULL(NEW.glnpayneedsettle,1), NEW.glnpayrefundexpire, NEW.entname),
            ('AMAZONPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.amazonpaychargerate,0), IFNULL(NEW.amazonpayrefundfactor,1), IFNULL(NEW.amazonpaytaxfactor,0), IFNULL(NEW.amazonpayneedsettle,1), NEW.amazonpayrefundexpire, NEW.entname),
            ('JCOINPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.jcoinpaychargerate,0), IFNULL(NEW.jcoinpayrefundfactor,1), IFNULL(NEW.jcoinpaytaxfactor,0), IFNULL(NEW.jcoinpayneedsettle,1), NEW.jcoinpayrefundexpire, NEW.entname),
            ('JKOPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.jkopaychargerate,0), IFNULL(NEW.jkopayrefundfactor,1), IFNULL(NEW.jkopaytaxfactor,0), IFNULL(NEW.jkopayneedsettle,1), NEW.jkopayrefundexpire, NEW.entname),
            ('BANKIT', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.bankitchargerate,0), IFNULL(NEW.bankitrefundfactor,1), IFNULL(NEW.bankittaxfactor,0), IFNULL(NEW.bankitneedsettle,1), NEW.bankitrefundexpire, NEW.entname),
            ('SMARTCODE', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.smartcodechargerate,0), IFNULL(NEW.smartcoderefundfactor,1), IFNULL(NEW.smartcodetaxfactor,0), IFNULL(NEW.smartcodeneedsettle,1), NEW.smartcoderefundexpire, NEW.entname),
            ('BANKPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.bankpaychargerate,0), IFNULL(NEW.bankpayrefundfactor,1), IFNULL(NEW.bankpaytaxfactor,0), IFNULL(NEW.bankpayneedsettle,1), NEW.bankpayrefundexpire, NEW.entname),
            ('ATONEPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.atonepaychargerate,0), IFNULL(NEW.atonepayrefundfactor,1), IFNULL(NEW.atonepaytaxfactor,0), IFNULL(NEW.atonepayneedsettle,1), NEW.atonepayrefundexpire, NEW.entname),
            ('AFTEEPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.afteepaychargerate,0), IFNULL(NEW.afteepayrefundfactor,1), IFNULL(NEW.afteepaytaxfactor,0), IFNULL(NEW.afteepayneedsettle,1), NEW.afteepayrefundexpire, NEW.entname),
            ('FAMIPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.famipaychargerate,0), IFNULL(NEW.famipayrefundfactor,1), IFNULL(NEW.famipaytaxfactor,0), IFNULL(NEW.famipayneedsettle,1), NEW.famipayrefundexpire, NEW.entname),
            ('EGIFTEE', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.egifteechargerate,0), IFNULL(NEW.egifteerefundfactor,1), IFNULL(NEW.egifteetaxfactor,0), IFNULL(NEW.egifteeneedsettle,1), NEW.egifteerefundexpire, NEW.entname),
            ('GOTOEAT', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.gotoeatchargerate,0), IFNULL(NEW.gotoeatrefundfactor,1), IFNULL(NEW.gotoeattaxfactor,0), IFNULL(NEW.gotoeatneedsettle,1), NEW.gotoeatrefundexpire, NEW.entname),
            ('MONEYTAP', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.moneytapchargerate,0), IFNULL(NEW.moneytaprefundfactor,1), IFNULL(NEW.moneytaptaxfactor,0), IFNULL(NEW.moneytapneedsettle,1), NEW.moneytaprefundexpire, NEW.entname),
            ('VISA', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.visachargerate,0), IFNULL(NEW.visarefundfactor,1), IFNULL(NEW.visataxfactor,0), IFNULL(NEW.visaneedsettle,1), NEW.visarefundexpire, NEW.entname),
            ('MARSTERCARD', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.mastercardchargerate,0), IFNULL(NEW.mastercardrefundfactor,1), IFNULL(NEW.mastercardtaxfactor,0), IFNULL(NEW.mastercardneedsettle,1), NEW.mastercardrefundexpire, NEW.entname),
            ('HAMAPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.hamapaychargerate,0), IFNULL(NEW.hamapayrefundfactor,1), IFNULL(NEW.hamapaytaxfactor,0), IFNULL(NEW.hamapayneedsettle,1), NEW.hamapayrefundexpire, NEW.entname),
            ('NISSENREN', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.nissenrenchargerate,0), IFNULL(NEW.nissenrenrefundfactor,1), IFNULL(NEW.nissenrentaxfactor,0), IFNULL(NEW.nissenrenneedsettle,1), NEW.nissenrenrefundexpire, NEW.entname),
            ('PAYPAL', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.paypalchargerate,0), IFNULL(NEW.paypalrefundfactor,1), IFNULL(NEW.paypaltaxfactor,0), IFNULL(NEW.paypalneedsettle,1), NEW.paypalrefundexpire, NEW.entname),
            ('MBBANKPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.mbbankpaychargerate,0), IFNULL(NEW.mbbankpayrefundfactor,1), IFNULL(NEW.mbbankpaytaxfactor,0), IFNULL(NEW.mbbankpayneedsettle,1), NEW.mbbankpayrefundexpire, NEW.entname),
            ('SPPREMIUM', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.sppremiumchargerate,0), IFNULL(NEW.sppremiumrefundfactor,1), IFNULL(NEW.sppremiumtaxfactor,0), IFNULL(NEW.sppremiumneedsettle,1), NEW.sppremiumrefundexpire, NEW.entname),
            ('NSPOINT', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.nspointchargerate,0), IFNULL(NEW.nspointrefundfactor,1), IFNULL(NEW.nspointtaxfactor,0), IFNULL(NEW.nspointneedsettle,1), NEW.nspointrefundexpire, NEW.entname),
            ('PROMPTPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.promptpaychargerate,0), IFNULL(NEW.promptpayrefundfactor,1), IFNULL(NEW.promptpaytaxfactor,0), IFNULL(NEW.promptpayneedsettle,1), NEW.promptpayrefundexpire, NEW.entname);
END $$
delimiter ;

delimiter $$
CREATE TRIGGER update_vertical after update ON wxbsbankaccount
    FOR EACH ROW
BEGIN
    DELETE FROM wxbsbankaccount_vertical WHERE acctname = NEW.acctname;
    INSERT INTO wxbsbankaccount_vertical(paymenttype,acctname,settletype,createtime,chargerate,refundfactor,taxfactor,needsettle,refundexpire,entname)
        values
            ('WECHATPAY', NEW.acctname, NEW.settleType, NEW.createtime, IFNULL(NEW.chargerate,0), IFNULL(NEW.excluderefunded,1), IFNULL(NEW.excisedutyfactor,0), IFNULL(NEW.wechatpayneedsettle,1), NEW.wechatpayrefundexpire, NEW.entname),
            ('ALIPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.alipaychargerate,0), IFNULL(NEW.alipayrefundfactor,1), IFNULL(NEW.alipaytaxfactor,0), IFNULL(NEW.alipayneedsettle,1), NEW.alipayrefundexpire, NEW.entname),
            ('LINEPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.linepaychargerate,0), IFNULL(NEW.linepayrefundfactor,1), IFNULL(NEW.linepaytaxfactor,1), IFNULL(NEW.linepayneedsettle,1), NEW.linepayrefundexpire, NEW.entname),
            ('DPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.dpaychargerate,0), IFNULL(NEW.dpayrefundfactor,1), IFNULL(NEW.dpaytaxfactor,1), IFNULL(NEW.dpayneedsettle,1), NEW.dpayrefundexpire, NEW.entname),
            ('CNPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.chinapaychargerate,0), IFNULL(NEW.chinapayrefundfactor,1), IFNULL(NEW.chinapaytaxfactor,0), IFNULL(NEW.chinapayneedsettle,1), NEW.chinapayrefundexpire, NEW.entname),
            ('PAYPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.paypaychargerate,0), IFNULL(NEW.paypayrefundfactor,1), IFNULL(NEW.paypaytaxfactor,0), IFNULL(NEW.paypayneedsettle,1), NEW.paypayrefundexpire, NEW.entname),
            ('RAKUTENPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.rakutenpaychargerate,0), IFNULL(NEW.rakutenpayrefundfactor,1), IFNULL(NEW.rakutenpaytaxfactor,0), IFNULL(NEW.rakutenpayneedsettle,1), NEW.rakutenpayrefundexpire, NEW.entname),
            ('UPI', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.upichargerate,0), IFNULL(NEW.upirefundfactor,1), IFNULL(NEW.upitaxfactor,0), IFNULL(NEW.upineedsettle,1), NEW.upirefundexpire, NEW.entname),
            ('ORIGAMIPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.origamipaychargerate,0), IFNULL(NEW.origamipayrefundfactor,1), IFNULL(NEW.origamipaytaxfactor,0), IFNULL(NEW.origamipayneedsettle,1), NEW.origamipayrefundexpire, NEW.entname),
            ('GINKOPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.ginkopaychargerate,0), IFNULL(NEW.ginkopayrefundfactor,1), IFNULL(NEW.ginkopaytaxfactor,0), IFNULL(NEW.ginkopayneedsettle,1), NEW.ginkopayrefundexpire, NEW.entname),
            ('MERPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.merpaychargerate,0), IFNULL(NEW.merpayrefundfactor,1), IFNULL(NEW.merpaytaxfactor,0), IFNULL(NEW.merpayneedsettle,1), NEW.merpayrefundexpire, NEW.entname),
            ('AUPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.aupaychargerate,0), IFNULL(NEW.aupayrefundfactor,1), IFNULL(NEW.aupaytaxfactor,0), IFNULL(NEW.aupayneedsettle,1), NEW.aupayrefundexpire, NEW.entname),
            ('QUOPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.quopaychargerate,0), IFNULL(NEW.quopayrefundfactor,1), IFNULL(NEW.quopaytaxfactor,0), IFNULL(NEW.quopayneedsettle,1), NEW.quopayrefundexpire, NEW.entname),
            ('VIADASH', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.viadashchargerate,0), IFNULL(NEW.viadashrefundfactor,1), IFNULL(NEW.viadashtaxfactor,0), IFNULL(NEW.viadashneedsettle,1), NEW.viadashrefundexpire, NEW.entname),
            ('VIAMPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.viampaychargerate,0), IFNULL(NEW.viampayrefundfactor,1), IFNULL(NEW.viampaytaxfactor,0), IFNULL(NEW.viampayneedsettle,1), NEW.viampayrefundexpire, NEW.entname),
            ('GLNPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.glnpaychargerate,0), IFNULL(NEW.glnpayrefundfactor,1), IFNULL(NEW.glnpaytaxfactor,0), IFNULL(NEW.glnpayneedsettle,1), NEW.glnpayrefundexpire, NEW.entname),
            ('AMAZONPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.amazonpaychargerate,0), IFNULL(NEW.amazonpayrefundfactor,1), IFNULL(NEW.amazonpaytaxfactor,0), IFNULL(NEW.amazonpayneedsettle,1), NEW.amazonpayrefundexpire, NEW.entname),
            ('JCOINPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.jcoinpaychargerate,0), IFNULL(NEW.jcoinpayrefundfactor,1), IFNULL(NEW.jcoinpaytaxfactor,0), IFNULL(NEW.jcoinpayneedsettle,1), NEW.jcoinpayrefundexpire, NEW.entname),
            ('JKOPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.jkopaychargerate,0), IFNULL(NEW.jkopayrefundfactor,1), IFNULL(NEW.jkopaytaxfactor,0), IFNULL(NEW.jkopayneedsettle,1), NEW.jkopayrefundexpire, NEW.entname),
            ('BANKIT', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.bankitchargerate,0), IFNULL(NEW.bankitrefundfactor,1), IFNULL(NEW.bankittaxfactor,0), IFNULL(NEW.bankitneedsettle,1), NEW.bankitrefundexpire, NEW.entname),
            ('SMARTCODE', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.smartcodechargerate,0), IFNULL(NEW.smartcoderefundfactor,1), IFNULL(NEW.smartcodetaxfactor,0), IFNULL(NEW.smartcodeneedsettle,1), NEW.smartcoderefundexpire, NEW.entname),
            ('BANKPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.bankpaychargerate,0), IFNULL(NEW.bankpayrefundfactor,1), IFNULL(NEW.bankpaytaxfactor,0), IFNULL(NEW.bankpayneedsettle,1), NEW.bankpayrefundexpire, NEW.entname),
            ('ATONEPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.atonepaychargerate,0), IFNULL(NEW.atonepayrefundfactor,1), IFNULL(NEW.atonepaytaxfactor,0), IFNULL(NEW.atonepayneedsettle,1), NEW.atonepayrefundexpire, NEW.entname),
            ('AFTEEPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.afteepaychargerate,0), IFNULL(NEW.afteepayrefundfactor,1), IFNULL(NEW.afteepaytaxfactor,0), IFNULL(NEW.afteepayneedsettle,1), NEW.afteepayrefundexpire, NEW.entname),
            ('FAMIPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.famipaychargerate,0), IFNULL(NEW.famipayrefundfactor,1), IFNULL(NEW.famipaytaxfactor,0), IFNULL(NEW.famipayneedsettle,1), NEW.famipayrefundexpire, NEW.entname),
            ('EGIFTEE', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.egifteechargerate,0), IFNULL(NEW.egifteerefundfactor,1), IFNULL(NEW.egifteetaxfactor,0), IFNULL(NEW.egifteeneedsettle,1), NEW.egifteerefundexpire, NEW.entname),
            ('GOTOEAT', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.gotoeatchargerate,0), IFNULL(NEW.gotoeatrefundfactor,1), IFNULL(NEW.gotoeattaxfactor,0), IFNULL(NEW.gotoeatneedsettle,1), NEW.gotoeatrefundexpire, NEW.entname),
            ('MONEYTAP', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.moneytapchargerate,0), IFNULL(NEW.moneytaprefundfactor,1), IFNULL(NEW.moneytaptaxfactor,0), IFNULL(NEW.moneytapneedsettle,1), NEW.moneytaprefundexpire, NEW.entname),
            ('VISA', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.visachargerate,0), IFNULL(NEW.visarefundfactor,1), IFNULL(NEW.visataxfactor,0), IFNULL(NEW.visaneedsettle,1), NEW.visarefundexpire, NEW.entname),
            ('MARSTERCARD', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.mastercardchargerate,0), IFNULL(NEW.mastercardrefundfactor,1), IFNULL(NEW.mastercardtaxfactor,0), IFNULL(NEW.mastercardneedsettle,1), NEW.mastercardrefundexpire, NEW.entname),
            ('HAMAPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.hamapaychargerate,0), IFNULL(NEW.hamapayrefundfactor,1), IFNULL(NEW.hamapaytaxfactor,0), IFNULL(NEW.hamapayneedsettle,1), NEW.hamapayrefundexpire, NEW.entname),
            ('NISSENREN', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.nissenrenchargerate,0), IFNULL(NEW.nissenrenrefundfactor,1), IFNULL(NEW.nissenrentaxfactor,0), IFNULL(NEW.nissenrenneedsettle,1), NEW.nissenrenrefundexpire, NEW.entname),
            ('PAYPAL', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.paypalchargerate,0), IFNULL(NEW.paypalrefundfactor,1), IFNULL(NEW.paypaltaxfactor,0), IFNULL(NEW.paypalneedsettle,1), NEW.paypalrefundexpire, NEW.entname),
            ('MBBANKPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.mbbankpaychargerate,0), IFNULL(NEW.mbbankpayrefundfactor,1), IFNULL(NEW.mbbankpaytaxfactor,0), IFNULL(NEW.mbbankpayneedsettle,1), NEW.mbbankpayrefundexpire, NEW.entname),
            ('SPPREMIUM', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.sppremiumchargerate,0), IFNULL(NEW.sppremiumrefundfactor,1), IFNULL(NEW.sppremiumtaxfactor,0), IFNULL(NEW.sppremiumneedsettle,1), NEW.sppremiumrefundexpire, NEW.entname),
            ('NSPOINT', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.nspointchargerate,0), IFNULL(NEW.nspointrefundfactor,1), IFNULL(NEW.nspointtaxfactor,0), IFNULL(NEW.nspointneedsettle,1), NEW.nspointrefundexpire, NEW.entname),
            ('PROMPTPAY', NEW.acctname,NEW.settleType,NEW.createtime, IFNULL(NEW.promptpaychargerate,0), IFNULL(NEW.promptpayrefundfactor,1), IFNULL(NEW.promptpaytaxfactor,0), IFNULL(NEW.promptpayneedsettle,1), NEW.promptpayrefundexpire, NEW.entname);
END $$
